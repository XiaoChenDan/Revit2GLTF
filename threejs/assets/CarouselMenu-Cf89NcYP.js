var $=Object.defineProperty;var q=(i,e,a)=>e in i?$(i,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[e]=a;var g=(i,e,a)=>q(i,typeof e!="symbol"?e+"":e,a);import{V as G,C as M,i as H,j as z,d as J,r as D,o as K,a as d,b as k,c as S,h as v,e as r,w as c,k as N,F,f as L,g as R,p as O,l as Q,_ as ee}from"./index-Drk0v8yT.js";const A=class A{constructor(e){g(this,"paths");g(this,"_tmp");g(this,"_cameraControls");g(this,"name");g(this,"selIndex");this._tmp=new G,this.paths=[],this._cameraControls=e,this.name="动画"+A.id++,this.selIndex=0}play(e){if(this.paths.length<=1||this.paths.length==e+1)return;let a=[],t=[];for(let p=e;p<this.paths.length;p++){const C=this.paths[p];a.push(C.position),t.push(C.target)}const u=new M(a),m=new M(t),b={value:0};let _=0,l=1/(this.paths.length-1);this._paly(u,m,b,_,l,this.paths[0].duration,0)}_paly(e,a,t,u,m,b,_){const l=this._tmp,h=this._cameraControls,p=this;H.fromTo(t,{value:u},{value:u+m,duration:b,overwrite:!0,paused:!0,ease:"none",onUpdateParams:[t],onUpdate({value:V}){if(!this.isActive())return;e.getPoint(V,l);const U=l.x,s=l.y,n=l.z;a.getPoint(V,l);const o=l.x,y=l.y,T=l.z;h.setLookAt(U,s,n,o,y,T,!1),h.update(),z.scene.render()},onStart(){h.enabled=!1},onComplete(){if(u+=m,u>=1){h.enabled=!0;return}_++,p._paly(e,a,t,u,m,p.paths[_].duration,_)}}).play(0)}addPath(e,a){this.paths.push({position:this._cameraControls.getPosition().clone(),target:this._cameraControls.getTarget().clone(),duration:e,url:a})}};g(A,"id",0);let B=A;const te=i=>(O("data-v-8f2b9258"),i=i(),Q(),i),ae={id:"carouselMenu"},oe={class:"menubuttons"},ne={class:"scrollbar-flex-content"},le=["src"],se={class:"input-container"},ce={class:"duration-input"},re=te(()=>v("span",{class:"duration-label"},"时间:",-1)),ie=J({__name:"CarouselMenu",setup(i){const e=D([]),a=D("");let t;K(()=>{e.value.length==0&&u()});const u=()=>{V(),p(),a.value=t.name},m=(s,n)=>{let o=Number(s.index);t=e.value[o]},b=()=>{C()},_=(s,n)=>{t=e.value[s],t.selIndex=n;let o=t.paths[t.selIndex];z.scene.flyTo(o.position.x,o.position.y,o.position.z,o.target.x,o.target.y,o.target.z)},l=()=>{t.play(t.selIndex)},h=s=>{const n=e.value.findIndex(o=>o.name===s);n!==-1&&(e.value.splice(n,1),e.value.length>0&&(a.value=e.value[0].name,t=e.value[0]))},p=()=>{t==null&&(t=new B(z.scene.controls),e.value.push(t))},C=()=>{p();let s=1,n=z.scene.renderer.domElement.toDataURL("image/jpeg");t&&(t.addPath(s,n),e.value=[...e.value],a.value=t.name)},V=()=>{t=null},U=(s,n,o)=>{e.value[s].paths[n].duration=o};return(s,n)=>{const o=d("el-button"),y=d("el-tooltip"),T=d("el-input-number"),j=d("el-card"),E=d("el-radio-button"),X=d("el-radio-group"),Y=d("el-scrollbar"),Z=d("el-tab-pane"),W=d("el-tabs");return k(),S("div",ae,[v("div",oe,[r(y,{effect:"dark",content:"新建动画",placement:"left"},{default:c(()=>[r(o,{circle:"",size:"large",type:"info",style:{"margin-top":"7px"},onClick:u},{default:c(()=>[N(" 新建 ")]),_:1})]),_:1}),r(y,{effect:"dark",content:"保存视角",placement:"left"},{default:c(()=>[r(o,{circle:"",size:"large",type:"info",style:{"margin-top":"7px","margin-left":"2px"},onClick:b},{default:c(()=>[N(" 拍摄 ")]),_:1})]),_:1}),r(y,{effect:"dark",content:"播放动画",placement:"left"},{default:c(()=>[r(o,{circle:"",size:"large",type:"info",style:{"margin-top":"7px","margin-left":"2px"},onClick:l},{default:c(()=>[N(" 播放 ")]),_:1})]),_:1})]),r(W,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=f=>a.value=f),onTabClick:m,onTabRemove:h},{default:c(()=>[(k(!0),S(F,null,L(e.value,(f,P)=>(k(),R(Z,{key:P,label:f.name,name:f.name,closable:""},{default:c(()=>[r(Y,null,{default:c(()=>[v("div",ne,[r(X,{modelValue:f.selIndex,"onUpdate:modelValue":x=>f.selIndex=x},{default:c(()=>[(k(!0),S(F,null,L(f.paths,(x,w)=>(k(),R(E,{value:w,key:w,class:"scrollbar-demo-item",onChange:I=>_(P,w)},{default:c(()=>[r(j,{"body-style":{padding:"0px"},shadow:"hover"},{default:c(()=>[v("img",{class:"image",src:x.url},null,8,le),v("div",se,[v("div",ce,[re,r(T,{modelValue:x.duration,"onUpdate:modelValue":I=>x.duration=I,min:.1,step:.1,size:"small","controls-position":"right",onChange:I=>U(P,w,I)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])]),_:2},1024)]),_:2},1032,["value","onChange"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}}),de=ee(ie,[["__scopeId","data-v-8f2b9258"]]);export{de as default};
