import{d as q,X as R,r as $,a as f,b as E,c as L,e as t,w as p,h as o,Y as N,j as g,Z as u,$ as j,a0 as T,a1 as A,p as F,l as H,_ as P}from"./index-Drk0v8yT.js";const Y=h=>(F("data-v-a1ce252e"),h=h(),H(),h),Z={key:0,class:"materialData"},G=Y(()=>o("div",{class:"materialData-header"}," 材质编辑 ",-1)),J={class:"selImg"},K=["src"],Q={class:"materialBox"},W={class:"selImg"},X=["src"],ee={class:"materialBox"},ae={class:"selImg"},le=["src"],se={class:"materialBox"},te={class:"selImg"},ne=["src"],oe={class:"materialBox"},ie={class:"selImg"},me=["src"],pe={class:"materialBox"},ue={class:"selImg"},de=["src"],re=q({__name:"MaterialComponent",setup(h,{expose:x}){const a=R({name:"",baseColor:"",baseMap:"./favicon.ico",alpha:0,roughnessMap:"./favicon.ico",roughness:0,metalnessMap:"./favicon.ico",metalness:0,aoMap:"./favicon.ico",aoMapIntensity:0,normalMap:"./favicon.ico",normalScale:0,displacementMap:"./favicon.ico",displacementScale:0,equaScale:!0,uScale:1,vScale:1,rotate:1,equaOffset:!0,xOffset:1,yOffset:1}),V=$(!1);let m,i,y;const _=s=>{let e=s.mesh.material;i=s,m=e,a.name=e.name,a.baseMap=c(e.map),e.transparent?a.alpha=e.opacity:a.alpha=1,a.roughness=e.roughness,a.roughnessMap=c(e.roughnessMap),a.metalness=e.metalness,a.metalnessMap=c(e.metalnessMap),a.normalMap=c(e.normalMap),a.aoMap=c(e.aoMap),a.aoMapIntensity=e.aoMapIntensity,a.displacementMap=c(e.displacementMap),a.normalScale=e.normalScale.x,e.map&&(a.uScale=e.map.repeat.x,a.vScale=e.map.repeat.y,a.rotate=e.map.rotation*180/Math.PI,a.xOffset=e.map.offset.x,a.yOffset=e.map.offset.y),g.getElementByID(s.id)&&(a.baseColor="#"+e.color.getHexString())},w=s=>{m&&u.changeBaseColor(s,m),u.saveMaterialData(i.mesh,i.id)},r=(s,e)=>{let M=s.srcElement,n=URL.createObjectURL(M.files[0]);switch(e){case 0:a.baseMap=n;break;case 1:a.roughnessMap=n;break;case 2:a.metalnessMap=n;break;case 3:a.aoMap=n;break;case 4:a.normalMap=n;break;case 5:a.displacementMap=n;break}u.changeMaterialMap(i.mesh,e,n)},S=s=>{s==1?(m.transparent=!1,m.side=j):(m.transparent=!0,m.side=T),m.opacity=s,u.saveMaterialData(i.mesh,i.id),g.scene.enableRender()},C=s=>{m.roughness=s,u.saveMaterialData(i.mesh,i.id),g.scene.enableRender()},O=s=>{m.metalness=s,u.saveMaterialData(i.mesh,i.id),g.scene.enableRender()},U=s=>{m.aoMapIntensity=s,u.saveMaterialData(i.mesh,i.id),g.scene.enableRender()},D=s=>{m.normalMap&&(m.normalScale=new A(s,-s),g.scene.enableRender()),u.saveMaterialData(i.mesh,i.id)},c=s=>{if(s==null||s.image==null)return"no.png";const e=y=y||document.createElement("canvas");return e.width=32,e.height=32,e.getContext("2d").drawImage(s.image,0,0,e.width,e.height),e.toDataURL(s.userData.mimeType)},v=(s,e)=>{m&&(a.equaScale&&(s?a.vScale=e:a.uScale=e),u.changeScale(s,e,m,a.equaScale),u.saveMaterialData(i.mesh,i.id))},z=s=>{m&&u.changeRotate(s,m),u.saveMaterialData(i.mesh,i.id)},b=(s,e)=>{m&&(a.equaOffset&&(s?a.yOffset=e:a.xOffset=e),u.changeOffset(s,e,m,a.equaOffset)),u.saveMaterialData(i.mesh,i.id)};return x({dialogVisible:V,showMeshMaterialData:_}),(s,e)=>{const M=f("el-input"),n=f("el-form-item"),k=f("el-color-picker"),d=f("el-slider"),I=f("el-switch"),B=f("el-form");return V.value?(E(),L("div",Z,[G,t(B,{size:"small","label-position":"left","label-width":"100px",model:a,style:{"margin-left":"10px","margin-right":"10px","margin-top":"5px","margin-bottom":"5px"}},{default:p(()=>[t(n,{label:"材质名称"},{default:p(()=>[t(M,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=l=>a.name=l)},null,8,["modelValue"])]),_:1}),t(n,{label:"基础颜色"},{default:p(()=>[t(k,{modelValue:a.baseColor,"onUpdate:modelValue":e[1]||(e[1]=l=>a.baseColor=l),onChange:e[2]||(e[2]=l=>w(a.baseColor))},null,8,["modelValue"])]),_:1}),t(n,{label:"基础贴图"},{default:p(()=>[o("div",J,[o("img",{src:a.baseMap,class:"myImg"},null,8,K),o("input",{type:"file",id:"file-input",accept:"image/*",onChange:e[3]||(e[3]=l=>r(l,0))},null,32)])]),_:1}),t(n,{label:"透明度"},{default:p(()=>[t(d,{modelValue:a.alpha,"onUpdate:modelValue":e[4]||(e[4]=l=>a.alpha=l),size:"small",min:0,max:1,step:.001,"show-input":!0,onInput:S,"show-input-controls":!1,class:"my-slider"},null,8,["modelValue"])]),_:1}),t(n,{label:"粗糙度贴图"},{default:p(()=>[o("div",Q,[o("div",W,[o("img",{src:a.roughnessMap,class:"myImg"},null,8,X),o("input",{type:"file",id:"file-input",accept:"image/*",onChange:e[5]||(e[5]=l=>r(l,1))},null,32)]),t(d,{modelValue:a.roughness,"onUpdate:modelValue":e[6]||(e[6]=l=>a.roughness=l),size:"small",min:0,max:1,step:.001,"show-input":!0,onInput:C,"show-input-controls":!1,class:"my-slider"},null,8,["modelValue"])])]),_:1}),t(n,{label:"金属度贴图"},{default:p(()=>[o("div",ee,[o("div",ae,[o("img",{src:a.metalnessMap,class:"myImg"},null,8,le),o("input",{type:"file",id:"file-input",accept:"image/*",onChange:e[7]||(e[7]=l=>r(l,2))},null,32)]),t(d,{modelValue:a.metalness,"onUpdate:modelValue":e[8]||(e[8]=l=>a.metalness=l),size:"small",min:0,max:1,step:.001,"show-input":!0,onInput:O,"show-input-controls":!1,class:"my-slider"},null,8,["modelValue"])])]),_:1}),t(n,{label:"遮蔽贴图"},{default:p(()=>[o("div",se,[o("div",te,[o("img",{src:a.aoMap,class:"myImg"},null,8,ne),o("input",{type:"file",id:"file-input",accept:"image/*",onChange:e[9]||(e[9]=l=>r(l,3))},null,32)]),t(d,{modelValue:a.aoMapIntensity,"onUpdate:modelValue":e[10]||(e[10]=l=>a.aoMapIntensity=l),size:"small",min:0,max:1,step:.001,"show-input":!0,"show-input-controls":!1,class:"my-slider",onInput:U},null,8,["modelValue"])])]),_:1}),t(n,{label:"法向贴图"},{default:p(()=>[o("div",oe,[o("div",ie,[o("img",{src:a.normalMap,class:"myImg"},null,8,me),o("input",{type:"file",id:"file-input",accept:"image/*",onChange:e[11]||(e[11]=l=>r(l,4))},null,32)]),t(d,{modelValue:a.normalScale,"onUpdate:modelValue":e[12]||(e[12]=l=>a.normalScale=l),size:"small",min:-10,max:10,step:.001,"show-input":!0,"show-input-controls":!1,class:"my-slider",onInput:D},null,8,["modelValue"])])]),_:1}),t(n,{label:"置换贴图"},{default:p(()=>[o("div",pe,[o("div",ue,[o("img",{src:a.displacementMap,class:"myImg"},null,8,de),o("input",{type:"file",id:"file-input",accept:"image/*",onChange:e[13]||(e[13]=l=>r(l,5))},null,32)]),t(d,{modelValue:a.displacementScale,"onUpdate:modelValue":e[14]||(e[14]=l=>a.displacementScale=l),size:"small",min:0,max:1,step:.001,"show-input":!0,"show-input-controls":!1,class:"my-slider"},null,8,["modelValue"])])]),_:1}),t(n,{label:"缩放"},{default:p(()=>[t(I,{modelValue:a.equaScale,"onUpdate:modelValue":e[15]||(e[15]=l=>a.equaScale=l),"active-text":"等比缩放"},null,8,["modelValue"])]),_:1}),t(n,{label:"U"},{default:p(()=>[t(d,{modelValue:a.uScale,"onUpdate:modelValue":e[16]||(e[16]=l=>a.uScale=l),size:"small",min:-10,max:10,step:.001,"show-input":!0,"show-input-controls":!1,class:"my-slider",onInput:e[17]||(e[17]=l=>v(!0,a.uScale))},null,8,["modelValue"])]),_:1}),t(n,{label:"V"},{default:p(()=>[t(d,{modelValue:a.vScale,"onUpdate:modelValue":e[18]||(e[18]=l=>a.vScale=l),size:"small",min:-10,max:10,step:.001,"show-input":!0,"show-input-controls":!1,class:"my-slider",onInput:e[19]||(e[19]=l=>v(!1,a.vScale))},null,8,["modelValue"])]),_:1}),t(n,{label:"位置偏移"}),t(n,{label:"旋转"},{default:p(()=>[t(d,{modelValue:a.rotate,"onUpdate:modelValue":e[20]||(e[20]=l=>a.rotate=l),size:"small",min:0,max:360,step:.1,"show-input":!0,"show-input-controls":!1,class:"my-slider",onInput:z},null,8,["modelValue"])]),_:1}),t(n,{label:"偏移"},{default:p(()=>[t(I,{modelValue:a.equaOffset,"onUpdate:modelValue":e[21]||(e[21]=l=>a.equaOffset=l),"active-text":"等比偏移"},null,8,["modelValue"])]),_:1}),t(n,{label:"横向偏移"},{default:p(()=>[t(d,{modelValue:a.xOffset,"onUpdate:modelValue":e[22]||(e[22]=l=>a.xOffset=l),size:"small",min:0,max:10,step:.01,"show-input":!0,"show-input-controls":!1,class:"my-slider",onInput:e[23]||(e[23]=l=>b(!0,a.xOffset))},null,8,["modelValue"])]),_:1}),t(n,{label:"纵向偏移"},{default:p(()=>[t(d,{modelValue:a.yOffset,"onUpdate:modelValue":e[24]||(e[24]=l=>a.yOffset=l),size:"small",min:0,max:10,step:.01,"show-input":!0,"show-input-controls":!1,class:"my-slider",onInput:e[25]||(e[25]=l=>b(!1,a.yOffset))},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])):N("",!0)}}}),fe=P(re,[["__scopeId","data-v-a1ce252e"]]);export{fe as default};
